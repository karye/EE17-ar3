<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="#">
    <title>Testar att visa Tiled karta i canvas</title>
    <link rel="stylesheet" href="./tiled.css">
</head>
<body>
    <canvas></canvas>
    <script>
        /* Element vi jobbar med */
        const eCanvas = document.querySelector("canvas");

        /* Ställ in bredd och storlek */
        /* Samma mått som i Tiled */
        eCanvas.width = 1280;
        eCanvas.height = 800;

        /* Starta ritmotorn */
        var ctx = eCanvas.getContext("2d");

        /* Objekten */
        var spelplan = {
            höjd: 25,
            bredd: 40,
            rutor: 16,
            bild: new Image(),
            karta: [97, 113, 114, 113, 114, 113, 114, 113, 114, 113, 114, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 97, 98, 7, 8, 8, 8, 8, 8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 97, 98, 23, 24, 24, 24, 24, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 98, 98, 23, 90, 24, 24, 24, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 46, 0, 0, 0, 0, 0, 0, 0, 46, 0, 0, 0, 0, 0, 0, 0, 0, 98, 0, 23, 24, 24, 24, 24, 24, 25, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 98, 0, 23, 24, 24, 24, 24, 24, 25, 43, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 130, 54, 53, 0, 0, 0, 0, 0, 0, 0, 46, 97, 98, 23, 24, 24, 86, 24, 24, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 130, 146, 53, 54, 52, 0, 46, 46, 46, 0, 0, 0, 113, 114, 39, 40, 40, 102, 90, 40, 41, 55, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 145, 146, 49, 52, 52, 52, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 55, 0, 52, 46, 27, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 27, 52, 0, 0, 0, 0, 0, 0, 0, 0, 55, 0, 0, 0, 52, 0, 43, 55, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 42, 52, 129, 130, 129, 130, 129, 130, 129, 0, 0, 0, 55, 0, 52, 49, 0, 1, 43, 55, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 42, 52, 145, 146, 49, 129, 130, 146, 49, 0, 0, 0, 0, 46, 52, 0, 55, 1, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 55, 0, 46, 0, 42, 52, 0, 129, 130, 145, 146, 129, 130, 0, 55, 0, 46, 0, 52, 49, 46, 1, 0, 0, 0, 0, 0, 0, 0, 46, 0, 0, 46, 0, 55, 50, 0, 129, 130, 0, 0, 129, 130, 46, 43, 52, 0, 145, 146, 0, 49, 145, 146, 0, 0, 97, 98, 52, 52, 52, 52, 52, 52, 52, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 145, 146, 29, 0, 145, 146, 52, 52, 52, 52, 52, 0, 0, 0, 90, 0, 0, 0, 113, 114, 0, 97, 98, 58, 59, 97, 98, 0, 0, 0, 0, 0, 0, 0, 0, 49, 51, 0, 129, 130, 52, 52, 52, 52, 52, 52, 52, 0, 0, 0, 52, 0, 0, 0, 0, 0, 0, 114, 28, 1, 0, 113, 114, 0, 0, 113, 114, 0, 0, 46, 0, 0, 0, 0, 0, 51, 49, 0, 145, 146, 52, 46, 0, 0, 0, 58, 59, 0, 0, 0, 52, 0, 0, 0, 0, 0, 0, 0, 97, 98, 0, 46, 29, 97, 98, 46, 52, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 52, 1, 51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 49, 0, 0, 113, 114, 0, 97, 98, 113, 114, 46, 52, 0, 52, 0, 0, 0, 0, 0, 0, 0, 129, 130, 0, 0, 0, 50, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 51, 46, 0, 113, 114, 0, 29, 30, 52, 52, 15, 49, 0, 0, 50, 0, 0, 46, 145, 146, 29, 129, 130, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 52, 31, 0, 129, 130, 46, 0, 0, 129, 130, 129, 130, 145, 146, 0, 0, 0, 0, 0, 12, 12, 12, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 52, 52, 30, 90, 146, 29, 0, 129, 161, 0, 0, 177, 130, 129, 130, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 90, 0, 0, 0, 0, 0, 53, 52, 0, 46, 6, 0, 0, 145, 162, 0, 0, 90, 162, 161, 146, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 98, 97, 98, 97, 98, 97, 98, 0, 0, 0, 52, 52, 0, 53, 46, 0, 0, 0, 0, 0, 0, 0, 0, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 97, 98, 97, 98, 97, 98, 97, 98, 0, 0, 51, 52, 77, 78, 129, 130, 29, 0, 0, 0, 0, 0, 0, 0, 161, 146, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 113, 114, 113, 114, 113, 114, 113, 114, 0, 0, 90, 52, 93, 94, 145, 146, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 49, 0, 0, 0, 0, 50, 0, 0, 0, 0, 50, 0, 0, 49]
        };

        /* Ladda in tileSheet */
        spelplan.bild.src = "./forest_tiles.png";

        function ritaSpelPlan() {
            var index = 0;

            /* Gå igenom varje rad på canvas */
            for (let rad = 0; rad < spelplan.höjd; rad++) {

                /* Gå igenom varje kolumn på canvas */
                for (let kol = 0; kol < spelplan.bredd; kol++) {

                    /* Rita inte ut om rutan är tom */
                    if (spelplan.karta[index] != 0) {

                        /* Räkna position i tilesheet */
                        var rutaX = Math.floor(spelplan.karta[index] % 16 - 1) * 32;
                        var rutaY = Math.floor(spelplan.karta[index] / 16) * 32;

                        /* Rita ut rutan på canvas */
                        ctx.drawImage(spelplan.bild, rutaX, rutaY, 32, 32, kol * 32, rad * 32, 32, 32);
                    }

                    /* Gå till nästa position på canvas */
                    index++;
                }
            }
        }

        spelplan.bild.addEventListener("load", ritaSpelPlan);
    </script>
</body>
</html>